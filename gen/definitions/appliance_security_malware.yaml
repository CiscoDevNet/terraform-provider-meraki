name: Appliance Security Malware
spec_endpoint: /networks/{networkId}/appliance/security/malware
rest_endpoint: /networks/%v/appliance/security/malware
put_create: true
no_delete: true
doc_category: Appliances
test_tags: [APPLIANCE_SECURITY_MALWARE]
test_variables: [test_org, test_network]
attributes:
  - tf_name: network_id
    type: String
    id: true
    reference: true
    description: Network ID
    example: L_123456
    test_value: meraki_network.test.id
  - model_name: mode
    type: String
    mandatory: true
    description: Set mode to `enabled` to enable malware prevention, otherwise `disabled`
    example: enabled
    enum_values: [disabled, enabled]
  - model_name: allowedFiles
    type: List
    description: The sha256 digests of files that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP allow listing
    attributes:
      - model_name: comment
        type: String
        mandatory: true
        description: Comment about the allowed entity
        example: allow ZIP file
      - model_name: sha256
        type: String
        id: true
        mandatory: true
        description: The file sha256 hash to allow
        example: e82c5f7d75004727e1f3b94426b9a11c8bc4c312a9170ac9a73abace40aef503
  - model_name: allowedUrls
    type: List
    description: The urls that should be permitted by the malware detection engine. If omitted, the current config will remain unchanged. This is available only if your network supports AMP allow listing
    attributes:
      - model_name: comment
        type: String
        mandatory: true
        description: Comment about the allowed entity
        example: allow help.com.au
      - model_name: url
        type: String
        id: true
        mandatory: true
        description: The url to allow
        example: help.com.au
test_prerequisites: |
  data "meraki_organization" "test" {
    name = var.test_org
  }
  resource "meraki_network" "test" {
    organization_id = data.meraki_organization.test.id
    name            = var.test_network
    product_types   = ["switch", "wireless", "appliance"]
  }
